{"title":"实时通信技术","slug":"实时通信技术","date":"2019-04-01T16:00:00.000Z","updated":"2019-04-02T05:18:29.155Z","comments":true,"path":"api/articles/实时通信技术.json","photos":[],"link":"","excerpt":"由于浏览器的限制，web通信过程都是客户端先发起请求，服务器再进行响应。如果需要做到即时通信（即服务器可以将数据更新实时推送到客户端），需要借助其他方式进行实现。目前实现 web 实时通信的方法主要有四种：轮询、长轮询、长链接(SSE)、websocket。总体上可以分为两类，一类是基于 http 实现的，如轮询、长轮询、SSE，另一类不是基于 http 实现的。即 websocket。","covers":null,"content":"<p>由于浏览器的限制，web通信过程都是客户端先发起请求，服务器再进行响应。如果需要做到即时通信（即服务器可以将数据更新实时推送到客户端），需要借助其他方式进行实现。目前实现 web 实时通信的方法主要有四种：轮询、长轮询、长链接(SSE)、websocket。总体上可以分为两类，一类是基于 http 实现的，如轮询、长轮询、SSE，另一类不是基于 http 实现的。即 websocket。</p>\n<a id=\"more\"></a>\n<h2 id=\"轮询（短轮询）\"><a href=\"#轮询（短轮询）\" class=\"headerlink\" title=\"轮询（短轮询）\"></a>轮询（短轮询）</h2><p>短轮询的实现方式很简单，就是不断的向服务器发起请求，询问服务器有没有新的资源，显然浪费很多的网络资源、服务器资源和客户端资源。每次请求都需要去建立链接，人数越多，服务器的压力越大。</p>\n<h2 id=\"长轮询\"><a href=\"#长轮询\" class=\"headerlink\" title=\"长轮询\"></a>长轮询</h2><p>长轮询即：客户端发起请求，服务器将请求 hold 主，直到有新的资源或者 timeout 才进行返回，返回后<strong>断开链接</strong>。相比于短轮询，可以节省不少资源。但是服务器也需要维持一个挂起链接，也会消耗资源，并且重新发起请求依然需要重新建立链接。</p>\n<h2 id=\"长链接-SSE\"><a href=\"#长链接-SSE\" class=\"headerlink\" title=\"长链接(SSE)\"></a>长链接(SSE)</h2><p>长链接与长轮询的主要差别在于客户端只需要发起一个链接，后续服务端有数据更新，会源源不断的从服务端发送过来，不需要每次请求都建立起链接。需要注意的是，服务端单方面推送，并不是全双工的过程。</p>\n<h2 id=\"websocket\"><a href=\"#websocket\" class=\"headerlink\" title=\"websocket\"></a>websocket</h2><p>下文摘自<a href=\"https://zh.wikipedia.org/wiki/WebSocket\" target=\"_blank\" rel=\"noopener\">维基百科</a></p>\n<blockquote>\n<p>websocket 是一种在单个 TCP 链接上进行全双工通信的协议。在 websocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直接可以创建持久连接，并进行双向数据传输。<br>优点：</p>\n<ul>\n<li>较少的控制开销。在创建链接后，服务器和客户端之间交换数据时，用于协议控制的数据包头部相对较小。</li>\n<li>更强的实时性。由于协议是全双工的，所以服务器可以随时主动给客户端下发数据。</li>\n<li>保持连接状态。与 HTTP 不同的是，websocket 需要先创建连接，这就使得其成为一种有状态的协议，之后的通信时可以省略部分状态信息。而HTTP请求可能需要在每个请求都携带状态信息（如身份认证）</li>\n<li>更好的支持二进制。websocket 定义了二进制帧，相对 HTTP，可以更轻松地处理二进制内容</li>\n<li>可以支持扩展。websocket 协议定义了扩展，用户可以扩展协议、实现部分自定义的子协议。</li>\n<li>更好的压缩效果。相对于 HTTP 压缩，websocket 在适当的扩展下，可以沿用之前内容的上下文，在传递类似的数据时，可以显著的提高压缩率</li>\n</ul>\n</blockquote>\n<p>最后，这里只是纪录一些知识点，供后续学习使用。</p>\n","categories":[{"name":"websocket","slug":"websocket","count":1,"path":"api/categories/websocket.json"}],"tags":[{"name":"轮询","slug":"轮询","count":1,"path":"api/tags/轮询.json"},{"name":"长轮询","slug":"长轮询","count":1,"path":"api/tags/长轮询.json"},{"name":"长链接","slug":"长链接","count":1,"path":"api/tags/长链接.json"},{"name":"websocket","slug":"websocket","count":1,"path":"api/tags/websocket.json"}]}